{% extends "base.html" %}
{% block title %}Register - Registraction{% endblock %}
{% block head %}
    <!-- Load reCAPTCHA v3 script -->
    <script src="https://www.google.com/recaptcha/api.js?render={{ recaptcha_site_key }}"></script>
    <script>
        // Execute reCAPTCHA when the form is submitted
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("registerForm").addEventListener("submit", function(event) {
                event.preventDefault(); // Prevent default submission
                grecaptcha.ready(function() {
                    grecaptcha.execute('{{ recaptcha_site_key }}', {action: 'register'})
                        .then(function(token) {
                            document.getElementById("recaptchaResponse").value = token;
                            document.getElementById("registerForm").submit();
                        });
                });
            });
        });
    </script>
{% endblock %}
{% block content %}
<div class="max-w-md mx-auto bg-white p-6 rounded-lg shadow-md">
    <h2 class="text-2xl font-semibold mb-4">Register as VIP</h2>
    <form id="registerForm" method="POST" action="/vip/register" class="space-y-4">
        <!-- Mandatory Fields -->
        <div>
            <label for="cellulare" class="block text-sm font-medium text-gray-700">Phone Number (Italian, 10 digits)</label>
            <input type="text" id="cellulare" name="cellulare" required
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                   placeholder="e.g., 3331234567 or +393331234567">
            <p class="text-xs text-gray-500 mt-1">Enter an Italian number (with or without +39).</p>
        </div>
        <div>
            <label for="Nome" class="block text-sm font-medium text-gray-700">First Name</label>
            <input type="text" id="Nome" name="Nome" required
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div>
            <label for="cognome" class="block text-sm font-medium text-gray-700">Last Name</label>
            <input type="text" id="cognome" name="cognome" required
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>

        <!-- Optional Fields -->
        <div>
            <label for="nascita" class="block text-sm font-medium text-gray-700">Date of Birth (Optional)</label>
            <input type="date" id="nascita" name="nascita"
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div>
            <label for="Email" class="block text-sm font-medium text-gray-700">Email (Optional)</label>
            <input type="email" id="Email" name="Email"
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div>
            <label for="Indirizzo" class="block text-sm font-medium text-gray-700">Address (Optional)</label>
            <input type="text" id="Indirizzo" name="Indirizzo"
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div>
            <label for="Citta" class="block text-sm font-medium text-gray-700">City (Optional)</label>
            <input type="text" id="Citta" name="Citta"
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div>
            <label for="Prov" class="block text-sm font-medium text-gray-700">Province (Optional)</label>
            <input type="text" id="Prov" name="Prov"
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div>
            <label for="Cap" class="block text-sm font-medium text-gray-700">Postal Code (Optional)</label>
            <input type="text" id="Cap" name="Cap"
                   class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
        </div>

        <!-- Hidden input for reCAPTCHA token -->
        <input type="hidden" id="recaptchaResponse" name="recaptcha_response">

        <!-- Warning Message -->
        {% if warning %}
            <p class="text-red-600 font-bold text-sm">{{ warning }}</p>
        {% endif %}

        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700">
            Register
        </button>
    </form>
</div>
{% endblock %}
